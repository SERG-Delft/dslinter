<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Data Leakage | DSLinter - Linter for Machine Learning - Specific Code Smells</title><meta name=keywords content="generic,model evaluation,error-prone"><meta name=description content="Use Pipeline() API in Scikit-Learn or check data segregation carefully when using other libraries to prevent data leakage."><meta name=author content><link rel=canonical href=https://hynn01.github.io/dslinter/posts/codesmells/9-data-leakage/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/dslinter/assets/css/stylesheet.min.118d582b9317eeb0017c428ab7f64c4be58e68881aeb263d9b75c61866e244de.css integrity="sha256-EY1YK5MX7rABfEKKt/ZMS+WOaIga6yY9m3XGGGbiRN4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/dslinter/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.96.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Data Leakage"><meta property="og:description" content="Use Pipeline() API in Scikit-Learn or check data segregation carefully when using other libraries to prevent data leakage."><meta property="og:type" content="article"><meta property="og:url" content="https://hynn01.github.io/dslinter/posts/codesmells/9-data-leakage/"><meta property="article:section" content="posts"><meta property="og:site_name" content="DSLinter - Linter for Machine Learning Application - Specific Code Smells"><meta name=twitter:card content="summary"><meta name=twitter:title content="Data Leakage"><meta name=twitter:description content="Use Pipeline() API in Scikit-Learn or check data segregation carefully when using other libraries to prevent data leakage."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hynn01.github.io/dslinter/posts/"},{"@type":"ListItem","position":2,"name":"Code Smells","item":"https://hynn01.github.io/dslinter/posts/codesmells/"},{"@type":"ListItem","position":3,"name":"Data Leakage","item":"https://hynn01.github.io/dslinter/posts/codesmells/9-data-leakage/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Data Leakage","name":"Data Leakage","description":"Use Pipeline() API in Scikit-Learn or check data segregation carefully when using other libraries to prevent data leakage.","keywords":["generic","model evaluation","error-prone"],"articleBody":"Description Context The data leakage occurs when the data used for training a machine learning model contains prediction result information.\nProblem Data leakage frequently leads to overly optimistic experimental outcomes and poor performance in real-world usage.\nSolution There are two main sources of data leakage: leaky predictors and a leaky validation strategy. Leaky predictors are the cases in which some features used in training are modified or generated after the goal value has been achieved. This kind of data leakage can only be inspected at the data level rather than the code level. Leaky validation strategy refers to the scenario where training data is mixed with validation data. This fault can be checked at the code level. One best practice in Scikit-Learn is to use the Pipeline() API to prevent data leakage.\nType Generic\nExisting Stage Model Evaluation\nEffect Error-prone\nExample ### Scikit-Learn from sklearn.model_selection import train_test_split from sklearn.feature_selection import SelectKBest from sklearn.ensemble import GradientBoostingClassifier from sklearn.metrics import accuracy_score import numpy as np + from sklearn.pipeline import make_pipeline  n_samples, n_features, n_classes = 200, 10000, 2 rng = np.random.RandomState(42) X = rng.standard_normal((n_samples, n_features)) y = rng.choice(n_classes, n_samples)  - X_selected = SelectKBest(k=25).fit_transform(X, y) - X_train, X_test, y_train, y_test = train_test_split(X_selected, y, random_state=42) - gbc = GradientBoostingClassifier(random_state=1) - gbc.fit(X_train, y_train) - y_pred = gbc.predict(X_test) + X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42) + pipeline = make_pipeline(SelectKBest(k=25), GradientBoostingClassifier(random_state=1)) + pipeline.fit(X_train, y_train) + y_pred = pipeline.predict(X_test)  accuracy_score(y_test, y_pred) Source: Paper  MPA Haakman. 2020. Studying the Machine Learning Lifecycle and Improving Code Quality of Machine Learning Applications. (2020).  Grey Literature GitHub Commit Stack Overflow  https://stackoverflow.com/questions/43816718/keras-regression-using-scikit-learn-standardscaler-with-pipeline-and-without-pip/43816833#43816833  Documentation  https://scikit-learn.org/stable/common_pitfalls.html  ","wordCount":"262","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://hynn01.github.io/dslinter/posts/codesmells/9-data-leakage/"},"publisher":{"@type":"Organization","name":"DSLinter - Linter for Machine Learning - Specific Code Smells","logo":{"@type":"ImageObject","url":"https://hynn01.github.io/dslinter/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hynn01.github.io/dslinter/ accesskey=h title="DSLinter - Linter for Machine Learning - Specific Code Smells (Alt + H)">DSLinter - Linter for Machine Learning - Specific Code Smells</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://hynn01.github.io/dslinter/posts/codesmells/ title="Code Smells"><span>Code Smells</span></a></li><li><a href=https://hynn01.github.io/dslinter/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://hynn01.github.io/dslinter/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hynn01.github.io/dslinter/>Home</a>&nbsp;»&nbsp;<a href=https://hynn01.github.io/dslinter/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://hynn01.github.io/dslinter/posts/codesmells/>Code Smells</a></div><h1 class=post-title>Data Leakage</h1><div class=post-meta></div></header><div class=post-content><h3 id=description>Description<a hidden class=anchor aria-hidden=true href=#description>#</a></h3><h4 id=context>Context<a hidden class=anchor aria-hidden=true href=#context>#</a></h4><p>The data leakage occurs when the data used for training a machine learning model contains prediction result information.</p><h4 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h4><p>Data leakage frequently leads to overly optimistic experimental outcomes and poor performance in real-world usage.</p><h4 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h4><p>There are two main sources of data leakage: leaky predictors and a leaky validation strategy. Leaky predictors are the cases in which some features used in training are modified or generated after the goal value has been achieved. This kind of data leakage can only be inspected at the data level rather than the code level. Leaky validation strategy refers to the scenario where training data is mixed with validation data. This fault can be checked at the code level. One best practice in Scikit-Learn is to use the <code>Pipeline()</code> API to prevent data leakage.</p><h3 id=type>Type<a hidden class=anchor aria-hidden=true href=#type>#</a></h3><p>Generic</p><h3 id=existing-stage>Existing Stage<a hidden class=anchor aria-hidden=true href=#existing-stage>#</a></h3><p>Model Evaluation</p><h3 id=effect>Effect<a hidden class=anchor aria-hidden=true href=#effect>#</a></h3><p>Error-prone</p><h3 id=example>Example<a hidden class=anchor aria-hidden=true href=#example>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>### Scikit-Learn
</span></span><span style=display:flex><span>from sklearn.model_selection import train_test_split
</span></span><span style=display:flex><span>from sklearn.feature_selection import SelectKBest
</span></span><span style=display:flex><span>from sklearn.ensemble import GradientBoostingClassifier
</span></span><span style=display:flex><span>from sklearn.metrics import accuracy_score
</span></span><span style=display:flex><span>import numpy as np
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ from sklearn.pipeline import make_pipeline
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>
</span></span><span style=display:flex><span>n_samples, n_features, n_classes = 200, 10000, 2
</span></span><span style=display:flex><span>rng = np.random.RandomState(42)
</span></span><span style=display:flex><span>X = rng.standard_normal((n_samples, n_features))
</span></span><span style=display:flex><span>y = rng.choice(n_classes, n_samples)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>- X_selected = SelectKBest(k=25).fit_transform(X, y)
</span></span></span><span style=display:flex><span><span style=color:#f92672>- X_train, X_test, y_train, y_test = train_test_split(X_selected, y, random_state=42)
</span></span></span><span style=display:flex><span><span style=color:#f92672>- gbc = GradientBoostingClassifier(random_state=1)
</span></span></span><span style=display:flex><span><span style=color:#f92672>- gbc.fit(X_train, y_train)
</span></span></span><span style=display:flex><span><span style=color:#f92672>- y_pred = gbc.predict(X_test)
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+ X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ pipeline = make_pipeline(SelectKBest(k=25), GradientBoostingClassifier(random_state=1))
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ pipeline.fit(X_train, y_train)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ y_pred = pipeline.predict(X_test)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>
</span></span><span style=display:flex><span>accuracy_score(y_test, y_pred)
</span></span></code></pre></div><h3 id=source>Source:<a hidden class=anchor aria-hidden=true href=#source>#</a></h3><h4 id=paper>Paper<a hidden class=anchor aria-hidden=true href=#paper>#</a></h4><ul><li>MPA Haakman. 2020. Studying the Machine Learning Lifecycle and Improving Code Quality of Machine Learning Applications. (2020).</li></ul><h4 id=grey-literature>Grey Literature<a hidden class=anchor aria-hidden=true href=#grey-literature>#</a></h4><h4 id=github-commit>GitHub Commit<a hidden class=anchor aria-hidden=true href=#github-commit>#</a></h4><h4 id=stack-overflow>Stack Overflow<a hidden class=anchor aria-hidden=true href=#stack-overflow>#</a></h4><ul><li><a href=https://stackoverflow.com/questions/43816718/keras-regression-using-scikit-learn-standardscaler-with-pipeline-and-without-pip/43816833#43816833>https://stackoverflow.com/questions/43816718/keras-regression-using-scikit-learn-standardscaler-with-pipeline-and-without-pip/43816833#43816833</a></li></ul><h4 id=documentation>Documentation<a hidden class=anchor aria-hidden=true href=#documentation>#</a></h4><ul><li><a href=https://scikit-learn.org/stable/common_pitfalls.html>https://scikit-learn.org/stable/common_pitfalls.html</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://hynn01.github.io/dslinter/tags/generic/>generic</a></li><li><a href=https://hynn01.github.io/dslinter/tags/model-evaluation/>model evaluation</a></li><li><a href=https://hynn01.github.io/dslinter/tags/error-prone/>error-prone</a></li></ul><nav class=paginav><a class=prev href=https://hynn01.github.io/dslinter/posts/codesmells/8-randomness-uncontrolled/><span class=title>« Prev Page</span><br><span>Randomness Uncontrolled</span></a>
<a class=next href=https://hynn01.github.io/dslinter/posts/codesmells/10-threshold-dependent-validation/><span class=title>Next Page »</span><br><span>Threshold-Dependent Validation</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://hynn01.github.io/dslinter/>DSLinter - Linter for Machine Learning - Specific Code Smells</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>